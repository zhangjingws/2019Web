!(function(n) {
  var e = Date.now ? Date.now() : +new Date(),
    t = n.performance || {},
    a = [],
    o = {},
    r = function(n, e) {
      for (var t = 0, o = a.length, r = []; t < o; t++)
        a[t][n] == e && r.push(a[t]);
      return r;
    },
    i = function(n, e) {
      for (var t, o = a.length; o--; )
        (t = a[o]).entryType != n ||
          (void 0 !== e && t.name != e) ||
          a.splice(o, 1);
    };
  t.now ||
    (t.now =
      t.webkitNow ||
      t.mozNow ||
      t.msNow ||
      function() {
        return (Date.now ? Date.now() : +new Date()) - e;
      }),
    t.mark ||
      (t.mark =
        t.webkitMark ||
        function(n) {
          var e = {
            name: n,
            entryType: "mark",
            startTime: t.now(),
            duration: 0
          };
          a.push(e), (o[n] = e);
        }),
    t.measure ||
      (t.measure =
        t.webkitMeasure ||
        function(n, e, t) {
          (e = o[e].startTime),
            (t = o[t].startTime),
            a.push({
              name: n,
              entryType: "measure",
              startTime: e,
              duration: t - e
            });
        }),
    t.getEntriesByType ||
      (t.getEntriesByType =
        t.webkitGetEntriesByType ||
        function(n) {
          return r("entryType", n);
        }),
    t.getEntriesByName ||
      (t.getEntriesByName =
        t.webkitGetEntriesByName ||
        function(n) {
          return r("name", n);
        }),
    t.clearMarks ||
      (t.clearMarks =
        t.webkitClearMarks ||
        function(n) {
          i("mark", n);
        }),
    t.clearMeasures ||
      (t.clearMeasures =
        t.webkitClearMeasures ||
        function(n) {
          i("measure", n);
        }),
    (n.performance = t),
    "function" == typeof define &&
      (define.amd || define.ajs) &&
      define("performance", [], function() {
        return t;
      });
})(window),
  (function(n) {
    var i = function() {
      var n = [].slice.call(arguments, 0);
      if (0 == n.length) throw new Error("method name required.");
      i[n[0]].apply(null, n.slice(1));
    };
    (i.options = {
      appid: 1e4,
      url: "https://qda.qidian.com",
      auto: !0,
      autoFlushResource: !0,
      rate: 0.1,
      customDefault: {},
      resourceFilter: function(n) {
        return !1;
      }
    }),
      (i.set = function(n) {
        i.options = p(i.options, n);
      }),
      (i._extra = {
        browser: null,
        n1: null,
        n2: null,
        n3: null,
        n4: null,
        n5: null,
        n6: null,
        n7: null,
        n8: null,
        n9: null,
        n10: null,
        s1: null,
        s2: null,
        s3: null,
        s4: null,
        s5: null,
        s6: null,
        s7: null,
        s8: null,
        s9: null,
        s10: null
      });
    var u,
      e = (function(n) {
        var e = document.cookie,
          t = e.indexOf(" " + n + "=");
        -1 == t && (t = e.indexOf(n + "="));
        if (-1 == t) e = null;
        else {
          t = e.indexOf("=", t) + 1;
          var o = e.indexOf(";", t);
          -1 == o && (o = e.length), (e = unescape(e.substring(t, o)));
        }
        return e;
      })("_qda_uuid");
    e && e.length
      ? (i._extra.uuid = e)
      : ((i._extra.uuid = (function() {
          function n() {
            return Math.floor(65536 * (1 + Math.random()))
              .toString(16)
              .substring(1);
          }
          return (
            n() +
            n() +
            "-" +
            n() +
            "-" +
            n() +
            "-" +
            n() +
            "-" +
            n() +
            n() +
            n()
          );
        })()),
        (function(n, e, t) {
          var o = new Date();
          o.setDate(o.getDate() + t);
          var r = escape(e) + (null == t ? "" : "; expires=" + o.toUTCString());
          document.cookie = n + "=" + r;
        })("_qda_uuid", i._extra.uuid, 3650)),
      navigator && navigator.connection && navigator.connection.effectiveType
        ? (i._extra.connection = navigator.connection.effectiveType)
        : (i._extra.connection = "-"),
      (i.extra = function(n) {
        for (prop in n)
          if (Object.prototype.hasOwnProperty.call(n, prop)) {
            if (void 0 === i._extra[prop])
              throw new Error(prop + " is not a valid extra prop.");
            /^n\d+$/.test(prop)
              ? (i._extra[prop] = Number(n[prop]))
              : (/^s\d+$/.test(prop), (i._extra[prop] = String(n[prop])));
          }
      }),
      (i.custom = function(n) {
        var t = p(p({ appid: i.options.appid }, i.options.customDefault), n);
        Object.keys(t).forEach(function(n) {
          if ("appid" == n) {
            if (!r(t[n])) throw new Error("appid must be a number.");
          } else if (-1 < n.indexOf("n_")) {
            if (!r(t[n])) throw new Error(n + " must be a number.");
          } else {
            if (!(-1 < n.indexOf("s_")))
              throw new Error(n + ": custom key must be start with n_ or s_.");
            if (!("string" == typeof (e = t[n]) || e instanceof String))
              throw new Error(n + " must be a string.");
          }
          var e;
        }),
          (t = p(t, i._extra)),
          Object.keys(t).forEach(function(n) {
            null === t[n] && delete t[n];
          }),
          c("/report", t);
      }),
      (i.send = ((u = !1),
      function() {
        if (!u) {
          var e;
          u = !0;
          var n = [
              "redirectStart",
              "redirectEnd",
              "fetchStart",
              "domainLookupStart",
              "domainLookupEnd",
              "connectStart",
              "connectEnd",
              "secureConnectionStart",
              "requestStart",
              "responseStart",
              "responseEnd",
              "unloadEventStart",
              "unloadEventEnd",
              "domInteractive",
              "domContentLoadedEventStart",
              "domContentLoadedEventEnd",
              "domComplete",
              "loadEventStart",
              "loadEventEnd"
            ],
            t = {};
          if (
            ((t.firstPaint = performance.getEntriesByName("first-paint").length
              ? performance
                  .getEntriesByName("first-paint")[0]
                  .startTime.toFixed(0)
              : null),
            (t.firstContentfulPaint = performance.getEntriesByName(
              "first-contentful-paint"
            ).length
              ? performance
                  .getEntriesByName("first-contentful-paint")[0]
                  .startTime.toFixed(0)
              : null),
            (i._extra = p(i._extra, t)),
            0 < performance.getEntriesByType("navigation").length)
          ) {
            var o = performance.getEntriesByType("navigation")[0];
            (e = {}),
              n.forEach(function(n) {
                e[n] = parseInt(o[n]);
              }),
              (e.name = o.name),
              (e.duration = parseInt(o.duration)),
              (e.nextHopProtocol = o.nextHopProtocol);
          } else
            try {
              var r = performance.timing,
                a = r.navigationStart;
              (e = {}),
                n.forEach(function(n) {
                  r[n] && (e[n] = r[n] - a);
                }),
                (e.name = location.href),
                (e.duration = r.loadEventEnd - a);
            } catch (n) {
              return void console.log(n);
            }
          (e.connectDuration = e.connectEnd - e.connectStart),
            (e.domContentLoadedEventDuration =
              e.domContentLoadedEventEnd - e.domContentLoadedEventStart),
            (e.domainLookupDuration = e.domainLookupEnd - e.domainLookupStart),
            (e.loadEventDuration = e.loadEventEnd - e.loadEventStart),
            (e.responseDuration = e.responseEnd - e.responseStart),
            (e.type = "navigation"),
            (e.url = location.href),
            (e.appid = i.options.appid),
            (e = p(e, i._extra)),
            Object.keys(e).forEach(function(n) {
              null === e[n] && delete e[n];
            }),
            c("/yep", e);
        }
      })),
      (i.flushResource = o),
      n.yep.q &&
        n.yep.q.forEach(function(n) {
          "send" != n[0]
            ? i.apply(null, n)
            : console.warn(
                "can not trigger send event manually before yep init."
              );
        });
    var t = !1;
    0 <= (n.yep = i).options.rate && i.options.rate <= 1
      ? (t = Math.random() < i.options.rate)
      : console.warn("rate out of range."),
      t
        ? i.options.auto && i.send()
        : ((i.send = function() {}),
          (i.flushResource = function() {}),
          (i.custom = function() {}));
    var s = {};
    function o() {
      performance.getEntriesByType("resource").forEach(function(n) {
        var e, t, o, r, a;
        n.reported ||
          s[n.name] ||
          ((n.reported = !0),
          (s[n.name] = !0),
          -1 < n.name.indexOf(i.options.url) ||
            (i.options.resourceFilter(n) &&
              ((r = [
                "name",
                "entryType",
                "startTime",
                "duration",
                "initiatorType",
                "nextHopProtocol",
                "fetchStart",
                "domainLookupStart",
                "domainLookupEnd",
                "connectStart",
                "connectEnd",
                "requestStart",
                "responseStart",
                "responseEnd"
              ]),
              (a = {}),
              (o = n) &&
                r.forEach(function(n) {
                  void 0 !== o[n] && (a[n] = o[n]);
                }),
              (e = a),
              (t = {
                appid: i.options.appid,
                type: "resource",
                url: location.href
              }),
              (e.domainLookupDuration =
                e.domainLookupEnd - e.domainLookupStart),
              (e.connectDuration = e.connectEnd - e.connectStart),
              (e.responseDuration = e.responseEnd - e.responseStart),
              (e = p((e = p(t, e)), i._extra)),
              Object.keys(e).forEach(function(n) {
                null === e[n] && delete e[n];
              }),
              c("/yep", e))));
      });
    }
    function c(o, r) {
      function n() {
        setTimeout(function() {
          var e,
            n = i.options.url + o,
            t = { data: encodeURIComponent(JSON.stringify(r)) };
          new Image().src =
            n +
            ((e = t),
            "?" +
              Object.keys(e)
                .map(function(n) {
                  return n + "=" + e[n];
                })
                .join("&"));
        }, 100);
      }
      "complete" == document.readyState
        ? n()
        : window.addEventListener("load", n, !1);
    }
    function p(n, e) {
      var t,
        o = {};
      for (t in n) Object.prototype.hasOwnProperty.call(n, t) && (o[t] = n[t]);
      for (t in e) Object.prototype.hasOwnProperty.call(e, t) && (o[t] = e[t]);
      return o;
    }
    function r(n) {
      return "number" == typeof n || n instanceof Number;
    }
    i.options.autoFlushResource && setInterval(o, 800);
  })(window);
